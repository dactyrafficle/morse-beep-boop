<!DOCTYPE html>
<html>

<textarea id='myInput' cols='20' rows='5'></textarea>

<button id='myButton'>play!</button>

<p id='myOutput'></p>


<script>

var myInput = document.getElementById('myInput');
myInput.value = 'sos';

var myOutput = document.getElementById('myOutput');

var encoding = {
  'a': [1, 2],
  'b': [2, 1, 1, 1],
  'c': [2, 1, 2, 1],
  'd': [2, 1, 1],
  'e': [1],
  'f': [1, 1, 2, 1],
  'g': [2, 2, 1],
  'h': [1, 1, 1, 1],
  'i': [1, 1],
  'j': [1, 2, 2, 2],
  'k': [2, 1, 2],
  'l': [1, 2, 1, 1],
  'm': [2, 2],
  'n': [2, 1],
  'o': [2, 2, 2],
  'p': [1, 2, 2, 1],
  'q': [2, 2, 1, 2],
  'r': [1, 2, 1],
  's': [1, 1, 1],
  't': [2],
  'u': [1, 1, 2],
  'v': [1, 1, 1, 2],
  'w': [1, 2, 2],
  'x': [2, 1, 1, 2],
  'y': [2, 1, 2, 2],
  'z': [2, 2, 1, 1],
  ' ': [0]
};



// input text will becomes a sequence of dots, dashes, spaces, and double spaces
// that should be the easy part


// first step, get an audio clip


var dot = new Audio('dot.mp3');
var dash = new Audio('dash.mp3');
var beep = new Audio('beep.mp3');
var boop = new Audio('boop.mp3');




var myButton = document.getElementById('myButton');
myButton.addEventListener('click', function() {
  var string = myInput.value;
  var morseArr = convertTextToMorseArr(string);
  playMorseArr(morseArr);
});

function convertTextToMorseArr(str) {
  var morseArr = [];
  var arr = str.split('');
  //console.log(arr);
  for (var i = 0; i < arr.length; i++) {
    morseArr = morseArr.concat(encoding[arr[i]]); // important bc '+' turns the 2 arrays into a string
	if (i !== arr.length-1 && arr[i] !== ' ') { // don't add a 0 if its a space or else you get 3x zeros in a row
	  morseArr.push(0);
	}
  }
  console.log(morseArr);
  return morseArr;
};

function playMorseArr(morseArr) {
  //console.log(morseArr);
  // result: start sound. finish sound. pause. start next sound. finish sound. pause. etc.
  for (let i = 0; i < morseArr.length; i++) {
    setTimeout(function() {
	  console.log(morseArr[i]);
	  if (morseArr[i] === 1) {
	    dot.play();
	  }
	  if (morseArr[i] === 2) {
	    dash.play();
	  }
	}, 250*i);
    // so this function works but i have to make sure i leave enough of a delay because if i dont
	// the new audio wont play if the last one is still running
	// and with the dashes, i might hear 2 dashes instead of 3, which naturally changes the meaning
	// so i need to get this syncronous bit down pat
  
  }
  

}


</script>
</html>